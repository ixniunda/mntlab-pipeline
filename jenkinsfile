node {
  def grdlHome
stage('Checkout') {
checkout([$class: 'GitSCM', branches: [[name: '*/alubouski']], doGenerateSubmoduleConfigurations: false, extensions: [], submoduleCfg: [], userRemoteConfigs: [[url: 'https://github.com/MNT-Lab/mntlab-pipeline.git']]])
}

 stage('Build') {
      // Run the gradle build
      grdlHome = tool 'gradle3.3'
      sh "'${grdlHome}/bin/gradle' build"
   }

 stage('Testing code') {
     parallel (
         cucumber: {sh "'${grdlHome}/bin/gradle' cucumber"},
           
            Unit_test : {sh "'${grdlHome}/bin/gradle' test"},
            
         jacocoTestReport : {sh "'${grdlHome}/bin/gradle' jacocoTestReport"}
         
            )
 }

stage('Triggering job'){
 build job: 'MNTLAB-alubouski-child1-build-job', parameters: [string(name: 'BRANCH_NAME', value: 'alubouski')]
 sh "cp $JENKINS_HOME/workspace/MNTLAB-alubouski-child1-build-job/alubouski_dsl_script.tar.gz $JENKINS_HOME/workspace/Pipeline-job1/"
 }
}
